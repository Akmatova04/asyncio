# Керектүү модулдарды импорттоо
import asyncio

# Асинхрондук функция (корутина) аныктоо, бул биздин кайталануучу тапшырмабыз
async def кайталануучу_тапшырма(ирет_номери):
    """
    Бул асинхрондук функция (корутина) кайсы иретте аткарылып жатканын
    билдирип, 1 секунд күтөт.
    """
    print(f"{ирет_номери}-тапшырма башталды...")
    # await asyncio.sleep(1) - 1 секунд асинхрондук күтүү.
    # Бул убакта башка асинхрондук тапшырмалар иштей алат (эгер бар болсо).
    await asyncio.sleep(1)
    print(f"{ирет_номери}-тапшырма аяктады.")
    return f"{ирет_номери}-тапшырма ийгиликтүү аткарылды"

# Негизги асинхрондук функция (корутина)
async def main():
    """
    Бул негизги асинхрондук функция 'кайталануучу_тапшырма' корутинасын
    циклдин ичинде бир нече жолу (бул учурда 5 жолу) чакырат.
    """
    кайталоо_саны = 5
    print(f"'кайталануучу_тапшырма' {кайталоо_саны} жолу аткарылат:\n")

    жыйынтыктар = [] # Ар бир тапшырманын жыйынтыгын сактоо үчүн тизме

    # 'for' цикли 'кайталоо_саны' жолу кайталанат
    for i in range(1, кайталоо_саны + 1): # 1ден 5ке чейин (кошо алганда)
        # 'await кайталануучу_тапшырма(i)' - бул жерде ар бир тапшырма
        # удаалаш (бири бүткөндөн кийин экинчиси) аткарылат, анткени
        # 'await' кийинки итерацияга өтүүдөн мурун учурдагы тапшырманын
        # аякташын күтөт.
        жыйынтык = await кайталануучу_тапшырма(i)
        жыйынтыктар.append(жыйынтык)
        print("-" * 20) # Бөлүүчү сызык

    print("\nБардык кайталануучу тапшырмалар аткарылды:")
    for ж in жыйынтыктар:
        print(ж)

    # Эгер тапшырмаларды конкуренттүү (бир убакта) аткаргыңыз келсе,
    # анда төмөнкүдөй кылсаңыз болот:
    # print("\nЭми тапшырмаларды asyncio.gather менен конкуренттүү аткаруу:")
    # тапшырма_объектилери = []
    # for i in range(1, кайталоо_саны + 1):
    #     тапшырма_объектилери.append(кайталануучу_тапшырма(i + кайталоо_саны)) # Номерлерин өзгөртөлү
    #
    # конкуренттуу_жыйынтыктар = await asyncio.gather(*тапшырма_объектилери)
    # print("\nКонкуренттүү тапшырмалардын жыйынтыктары:")
    # for ж in конкуренттуу_жыйынтыктар:
    #     print(ж)


# Программа түздөн-түз иштетилгенде
if __name__ == "__main__":
    # asyncio.run() функциясы 'main' асинхрондук функциясын ишке киргизет.
    asyncio.run(main())